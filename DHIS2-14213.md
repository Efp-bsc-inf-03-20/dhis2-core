# DHIS2-14213

### Cases

Tracker import cases with

AtomicMode.OBJECT

and the import strategy defined in the headers.

#### Import Strategy: Create

The first table lists an import with a hierarchy of one trackedEntity (TEI), enrollment (EN) and
event (EV). 1 means the entity is valid, 0 means it is invalid. The create column shows what
entities the importer would create.

| Nr | TEI  | EN  | EV  | Create   |
|----|---|---|---|---|
| 1|  0|  0|  0|  Nothing|
| 2|  0|  0|  1|  Nothing|
| 3|  0|  1|  0|  Nothing|
| 4|  0|  1|  1|  Nothing|
| 5|  1|  0|  0|  TEI|
| 6|  1|  0|  1|  TEI|
| 7|  1|  1|  0|  TEI, EN|
| 8|  1|  1|  1|  TEI, EN, EV|

I think relationships can be handled separately. As the above can be imported irrespective of
whether they also have a valid or invalid relationship. A relationship has two direct children
from/to each of which could be a TEI/EN/EV.

We have the same number of cases as above as the relationship could itself be invalid. For example
if the relationship type is invalid.

| Nr | REL  | FROM  | TO  | Create   |
|----|---|---|---|---|
| 1|  0|  0|  0|  Nothing|
| 2|  0|  0|  1|  Nothing|
| 3|  0|  1|  0|  Nothing|
| 4|  0|  1|  1|  Nothing|
| 5|  1|  0|  0|  Nothing|
| 6|  1|  0|  1|  Nothing|
| 7|  1|  1|  0|  Nothing|
| 8|  1|  1|  1|  Relationship|

#### Import Strategy: Update

This assumes that all entities already exist. Its a pure update.

| Nr | TEI  | EN  | EV  | Update   |
|----|---|---|---|---|
| 1|  0|  0|  0|  Nothing|
| 2|  0|  0|  1|  EV|
| 3|  0|  1|  0|  EN|
| 4|  0|  1|  1|  EN, EV|
| 5|  1|  0|  0|  TEI|
| 6|  1|  0|  1|  TEI, EV|
| 7|  1|  1|  0|  TEI, EN|
| 8|  1|  1|  1|  TEI, EN, EV|

#### Import Strategy: Create_And_Update

If all entities are new we fallback to the table in import strategy create.

The table we established during import strategy create now has another dimension which is whether an
entity exists or not. I will present the table iterating through each column from let to right by
making one version where the column marked as `*` is an existing entity.

##### TEI exists

TEI exists, others are new.

| Nr | TEI*  | EN  | EV  | Result   | Explanation |
|----|---|---|---|---|---|
| 1|  0|  0|  0|  Nothing||
| 2|  0|  0|  1|  Nothing|cannot create event as its parent is invalid and does not exist|
| 3|  0|  1|  0|  Create EN|can create enrollment as its parent is invalid but exists|
| 4|  0|  1|  1|  Create EN, EV|can create both children as their respective parents either exist or are valid|
| 5|  1|  0|  0|  Update TEI||
| 6|  1|  0|  1|  Update TEI||
| 7|  1|  1|  0|  Update TEI, Create EN||
| 8|  1|  1|  1|  Update TEI, Create EN, EV||

